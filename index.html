<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pokemon</title>

</head>
<body>
<div id="pregunta"></div>
<div id="respuesta"></div>
<div id="resultado"></div>

  <script type="text/javascript" src="http://code.jquery.com/jquery-3.1.1.min.js"></script>

  <script type="text/javascript">
	

	var pokemones = $.ajax({type: "GET", url: "pokemon_json.js", async: false}).responseText;
	var pokemones = jQuery.parseJSON( pokemones );
	var preguntas = $.ajax({type: "GET", url: "preguntas.js", async: false}).responseText;
	var preguntas = jQuery.parseJSON( preguntas );
	$( document ).ready(function() {
	QuienEsEsePokemon(0)
	});

	function QuienEsEsePokemon(numero_pregunta){
		if(numero_pregunta != 0){
			if(numero_pregunta<11){
				filtro = $("#filtro").val();
				pokemones = Filtro(pokemones,filtro ,numero_pregunta);
				console.log(pokemones);
				cantidad = pokemones.length;
				if(cantidad == 1){
					alert("pokemon encontrado es:" + pokemones[0].nombre);
					$("#respuesta").html("");
					$("#pregunta").html("");
					$("#resultado").html("<img src='http://www.pokestadium.com/sprites/xy/" + pokemones[0].nombre.toLowerCase() + ".gif' />");
				}
				if(cantidad == 0){
					$("#respuesta").html("");
					$("#pregunta").html("");
					alert("pokemon no encontrado");
					$("#resultado").html('<input type="button" value="Jugar de Nuevo" onClick="window.location.reload()">');
				}
				if(cantidad>1){
					$("#pregunta").html(preguntas[numero_pregunta].pregunta);
					numero_pregunta = numero_pregunta +1;
				$("#respuesta").html("<input type='text' name='filtro' id='filtro'><a href='javascript:QuienEsEsePokemon("+ numero_pregunta+ ");'>Siguiente</a>");
				}

			}else{
				$("#respuesta").html("");
					$("#pregunta").html("");
					alert("pokemon no encontrado");
					$("#resultado").html('<input type="button" value="Refresh Page" onClick="window.location.reload()">');

			}
			
		}else{
			$("#pregunta").html("Â¿Que tipo de pokemon es?");
				numero_pregunta = numero_pregunta +1;
			$("#respuesta").html("<input type='text' name='filtro' id='filtro'><a href='javascript:QuienEsEsePokemon(1);'>Siguiente</a>");
		}
	}

	function Filtro(pokemones,filtro, numero_pregunta){
		var nuevos = new Array()
		for(var i=0; i<pokemones.length; i++){
			
			var existe = 0;

			var objeto = new Object();
			var auxiliar;
			if(numero_pregunta == 1){
				if(pokemones[i].tipo1.toUpperCase() == filtro.toUpperCase()){
					auxiliar = pokemones[i];
					existe = 1;
					
				}
			}
			if(numero_pregunta == 2){
				if(pokemones[i].evoluciona.toUpperCase() == filtro.toUpperCase()){

					auxiliar = pokemones[i];
					existe = 1;
					
				}
			}
			if(numero_pregunta == 3){
				if(pokemones[i].animal.toUpperCase() == filtro.toUpperCase()){

					auxiliar = pokemones[i];
					existe = 1;
					
				}
			}
			if(numero_pregunta == 4){
				if(pokemones[i].accion.toUpperCase() == filtro.toUpperCase()){

					auxiliar = pokemones[i];
					existe = 1;
					
				}
			}
			if(numero_pregunta == 5){
				if(pokemones[i].habitat.toUpperCase() == filtro.toUpperCase()){

					auxiliar = pokemones[i];
					existe = 1;
					
				}
			}
			if(numero_pregunta == 6){
				if(pokemones[i].evolucionado.toUpperCase() == filtro.toUpperCase()){

					auxiliar = pokemones[i];
					existe = 1;
					
				}
			}
			if(numero_pregunta == 7){
				if(pokemones[i].tipo_evo.toUpperCase() == filtro.toUpperCase()){

					auxiliar = pokemones[i];
					existe = 1;
					
				}
			}
			if(numero_pregunta == 8){
				if(pokemones[i].raro.toUpperCase() == filtro.toUpperCase()){

					auxiliar = pokemones[i];
					existe = 1;
					
				}
			}
			if(numero_pregunta == 9){
				if(pokemones[i].tipo2.toUpperCase() == filtro.toUpperCase()){

					auxiliar = pokemones[i];
					existe = 1;
					
				}
			}
			if(numero_pregunta == 10){
				if(pokemones[i].sexo.toUpperCase() == filtro.toUpperCase()){

					auxiliar = pokemones[i];
					existe = 1;
					
				}
			}


			if(existe == 1){
				objeto.numero = auxiliar.numero;
				objeto.nombre = auxiliar.nombre;
				objeto.tipo1 = auxiliar.tipo1;
				objeto.tipo2 = auxiliar.tipo2;
				objeto.evoluciona = auxiliar.evoluciona;
				objeto.animal = auxiliar.animal;
				objeto.accion = auxiliar.accion;
				objeto.sexo = auxiliar.sexo;
				objeto.raro = auxiliar.raro;
				objeto.habitat = auxiliar.habitat;
				objeto.cant_evo = auxiliar.cant_evo;
				objeto.evolucionado = auxiliar.evolucionado;
				objeto.tipo_evo = auxiliar.tipo_evo;
				nuevos.push(objeto);

			}
			
		}

		return nuevos;
	}
	</script>
</body>
</html>


